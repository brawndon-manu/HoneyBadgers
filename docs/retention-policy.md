# Log & Data Retention Policy
**Author:** Dev E - Security & Compliance
**Version:** 1.0
**Date:** 2025-11-30

---

## 1. Purpose 
This policy defines how logs and security-relevant data are retained, archived, and deleted.
It ensures compliance with ISO/IEC 27001 Annex A.12 (Operations Security) and supports forensic investigations.

---

## 2. Scope
Applies to all log data generated by:
- Cowrie Honeypot EC2
- Parser Lambda
- WAF Automation Lambda
- DynamoDB (ThreatIntel + blocked IP metadata)
- API Gateway (if enabled)
- VPC Flow Logs (optional)
- GuardDuty findings

---

## 3. Retention Requirements

### **3.1 Hot Storage (CloudWatch Logs)**
Logs actively used for monitoring, troubleshooting, and security detection.

- Retention: **90 days**
- Location: CloudWatch Logs
- Applies to:
    - `/honeypot/events`
    - `/aws/lambda/parser`
    - `/aws/lambda/waf_automation`
    - `/aws/apigw/*` (if enabled)
    - `/aws/vpc/flow-logs/*` (if enabled)

**Rationale:**
90 days allows for effective incident investigation and aligns with common SOC2 & ISO security windows.

---

### **3.2 Cold Storage (S3 Archive)**
Logs older than 90 days must be exported to S3 for long-term archival.

**Storage Location:** `s3://project-logs-archive/<env>/<year>/`
**Retention:** 365 days
**Encryption:** AES-256 orr AWS KMS
**Access Level:** restricted to Dev A + Dev E only

S3 bucket must:
- block all public access
- enable object versioning
- enforce lifecycle policies
- automatically delete logs after one year

---

### **3.3 DynamoDB Records**
**ThreatIntel table** and **blocked IP metadata**:
- TTL-enabled attributes should automatically purge stale entries
- **Retention:** up to 30 days after last update
- Records relevant to WAF automation must be kept until the TTL expiration

---

## 4. Protection of Log Data

### Permissions:
IAM permissions follow **least privilege**
- Only authorized roles:
    - Dev A: Infra
    - Dev C: Backend
    - Dev E: Compliance

### Security Controls:
- **S3 logs:** server-side encryption (SSE-S3 or SSE-KMS)
- **CloudWatch Logs:** protected by IAM policies
- No logs may be publicly accessible

---

## 5. Responsibilities

### **Dev A**
Configure:
- CloudWatch retention settings
- S3 lifecycle rules

### **Dev B**
- Ensure honeypot EC2 forwards logs correctly
- Monitr CloudWatch agent health

### **Dev C**
- Ensure Lambda functions produce useful logs
- Maintain structured logging format

### **Dev E**
- Maintain this retention policy
- Verify retention settings quarterly
- Provide updates during compliance reviews

---

## 6. Review Cycle
This policy must be reviewed at least **every six months** or when:
- log sources change
- regulatory requirements change
- security incidents require updated retention windows
